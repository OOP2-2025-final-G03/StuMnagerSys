{% extends "content_base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/user_form.css') }}">
{% endblock %}

{% block page_title %}
{{ 'ユーザー編集' if user else 'ユーザー新規登録' }}
{% endblock %}

{% block main_content %}
<div class="dashboard-card user-form-card">

  <h2>{{ 'ユーザー編集' if user else 'ユーザー新規登録' }}</h2>

  <form id="user-form"
        data-mode="{{ 'edit' if user else 'create' }}"
        {% if user %}data-user-id="{{ user.id }}"{% endif %}>

    <div class="form-grid">

      <div class="form-group">
        <label>ユーザーID</label>
        <input type="text" id="user_id"
               value="{{ user.user_id if user else '' }}"
               {{ 'readonly' if user else 'required' }}>
      </div>

      <div class="form-group">
        <label>名前</label>
        <input type="text" id="name"
               value="{{ user.name if user else '' }}"
               required>
      </div>

      <div class="form-group">
        <label>生年月日</label>
        <input type="date" id="birth_date"
               value="{{ user.birth_date if user else '' }}">
      </div>

      <div class="form-group">
        <label>権限</label>
        <select id="role" required>
          <option value="student">学生</option>
          <option value="teacher">教師</option>
          <option value="superuser">管理者</option>
        </select>
      </div>

      <div class="form-group">
        <label>所属</label>
        <input type="text" id="department"
               value="{{ user.department if user else '' }}">
      </div>

      <div class="form-group">
        <label>{{ '新しいパスワード（変更時のみ）' if user else '初期パスワード' }}</label>
        <input type="password" id="password"
               {{ 'required' if not user }}>
      </div>

    </div>

    <button type="submit" class="btn-primary">
      {{ '更新' if user else '登録' }}
    </button>

  </form>

  <p id="message" class="message"></p>
</div>
{% endblock %}
